series:
  type: table
  displayName: Series
  order: '10'
  besql: true
  primaryKey: ID
  scheme:
    columns:
    - ID:
        type: KEYTYPE
        autoIncrement: true
        primaryKey: true
    - GSE:
        type: VARCHAR(10)
    - PMID:
        type: KEYTYPE
    - organism:
        type: KEYTYPE
        reference: organisms
    - type:
        type: VARCHAR(10)
    - title:
        type: VARCHAR(500)
    - description:
        type: VARCHAR(4000)
    - design:
        type: VARCHAR(4000)
  queries:
  - '*** Selection view ***':
      type: 1D
      code: |-
          SELECT ID AS "ID", 
          GSE AS "Name"
          FROM series
  - All records:
      defaultView: true
      type: 1D
      roles: '@AllRoles'
      operations:
      - AddRemoveCategory
      - Filter
      code: |-
          SELECT DISTINCT
            s.ID AS "___ID",
            s.GSE AS "GSE",
            s.title AS "Title",
            '<link table="series" queryName="Details" using="___ID" columns="ID" />' AS ";Title",
            o.title AS "Organism;<quick visible='true' />",
            s.type AS "Type",
            s.description AS "Description;<quick visible='false' />"
          FROM series s
          LEFT JOIN organisms o ON o.id = s.organism
  - Details:
      type: 1D
      roles: '@AllRoles'
      code: |-
          SELECT DISTINCT
            s.ID AS "___ID",
            s.GSE AS "GSE",
            s.title AS "Title",
            o.title AS "Organism",
            s.type AS "Type",
            s.description AS "Description"
          FROM series s
          LEFT JOIN organisms o ON o.id = s.organism
          WHERE (1=1)
          <if parameter="ID">
              AND s.ID = <parameter:ID/>
          </if>
  operations:
  - AddRemoveCategory:
      records: 2
      roles: Annotator
      code: com.developmentontheedge.be5.modules.core.operations.categories.AddRemoveCategory
  - Filter:
      roles: Administrator
      layout: '{"type":"modalForm"}'
      code: com.developmentontheedge.be5.server.operations.FilterOperation
